{% extends 'website/base.html' %}

{% block custom_css %}
<style type="text/css">
  .fa-plus {
    color: var(--primary-color) !important;
  }

#myInput {
  width: 50%;
  border-radius: 10px;
  border-color: var(--secondary-color) !important;
  outline: none;
}
.btn {
  width: 100%;
  background-color: var(--primary-color) !important;
}
.fa-edit {
    color: var(--primary-color) !important;
}
.fa-plus {
  color: var(--primary-color) !important;
}
thead {
  background-color: var(--secondary-color) !important;
  color: white;
}
th {
  border-top-right-radius: 10px;
  border-top-left-radius: 10px;
}
.label {
  font-weight: bold;
}
.heading {
  text-align: center;
}
 .value {
   float: right;
   width: 50%;
 }
</style>
{% endblock custom_css %}

{% block content %}
<div class="container">
<div class="row">
  <div class="col-md-8 col-lg-4">
    <table class="table">
      <thead>
        <tr>
          <th colspan="2" class="heading">
            <h2>Client Informtation</h2>
          </th>
        </tr>
      </thead>
      <tbody>
            <tr><th>Client: </th><td>
                <select id="client">
                    <option selected>------------</option>
                  {% for client in clients %}
                    <option value="{{ client }}">{{ client }}</option>
                  {% endfor %}
                </select>
                </td>
                </tr>
                <tr><th>Project: </th><td>
                    <select id="project">
                        <option selected>------------</option>
                      {% for project in projects %}
                        <option value="{{ project.client }}">{{ project }}</option>
                      {% endfor %}
                    </select>
                    </td>
                    </tr>
            <tr><th>Total</th><td><strong style="text-align: right; float: right;" class="total"></strong></td></tr>
      </tbody>
    </table>
    <button id="save" type="submit" value="save" class="btn btn-success">Add Cost</button>
    </div>
    <div class="col-md-8 col-lg-4">
    <table class="table">
      <thead>
        <tr>
          <th colspan="2" class="heading">
            <h2>Hourly Costs</h2>
          </th>
        </tr>
      </thead>
      <tbody>
        {% for service in services %}
        <tr><th>{{ service|title }} Hours: </th><td><input class="value" type="number" name="{{ service.cost_per_hour }}"></input>
        {% endfor %}
      </tbody>
    </table>
    </div>
    <div class="col-md-8 col-lg-4">
    <table class="table">
      <thead>
        <tr>
          <th colspan="3" class="heading">
            <h2>Extra Costs</h2>
          </th>
        </tr>
      </thead>
      <tbody class="extras">
        <tr><th colspan="2">
          <button class="btn btn-success add_form_field">Add Extra Cost
          </button></th>
        </tr>
        <tr>
          <th>Label</th>
          <th>Price</th>
        </tr>
      </tbody>
    </table>
    </div>
</div>
</div>
{% endblock content %}

{% block js %}
<script>
    $('.value').on("keyup", function() {
      var total = 0;
        $('.value').each(function(){
          console.log($(this).val())
          if (isNaN(parseInt($(this).val()))) {
          }
          else {
              total += (parseInt($(this).val()) * parseInt($(this).attr("name")));
              console.log(total);
          }
      });
        $('.total').html('$' + total);
    });
    //--------------------------------------------------------------------------
    var sel2 = $('#project').html();
    $('#client').change(function() {
        $('#project').html(sel2);
        $('#project option').each(function() {
            if ($(this).val() != $('#client').val()) $(this).remove();
        });
    });
    //------------------------------------------------------------------------
    $(document).ready(function() {
    var max_fields = 10;
    var wrapper = $(".extras");
    var add_button = $(".add_form_field");

    var x = 1;
    $(add_button).click(function(e) {
      e.preventDefault()
        if (x < max_fields) {
            x++;
            $(wrapper).append('<tr><td><input type="text" name="label"/></td><td><input class="value" type="text" name="1.00"/></td><td><a href="#" class="fas fa-trash-alt delete"></a></td></tr>'); //add input box
        } else {
            alert('You Reached the limits')
        }
    });

    $(wrapper).on("click", ".delete", function(e) {
        e.preventDefault();
        $(this).closest('tr').remove();
        x--;
    })
});

</script>
{% endblock js %}
