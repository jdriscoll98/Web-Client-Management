{% extends 'website/base.html' %}

{% block custom_css %}
<style>
  .fa-plus {
    color: var(--primary-color) !important;
  }
</style>
{% endblock custom_css %}

{% block content %}
{% include 'website/server_messages.html' %}

<div class="container">
  <div class="row">
    <div class="col text-center">
      <h2 class="title">Welcome to Tech and Mech Client Management</h2><br/>
    </div>
  </div>
  <div class="row">
    <div class="col-md-4 text-center">
      <table id="client-table" class="table">
        <thead>
          <tr>
            <th colspan="2" class="heading">
              <h2>
          Clients
          <a class="fas fa-plus" href="{% url 'management:add_client' %}"></a>
          </h2>
          </th>
          </tr>
          </thead>
          <tbody>
        {% for client in clients %}
        <tr id="row-{{ client.pk }}" ><td class="client" href="{% url 'management:detail_client' client.pk %}">{{ client.name }}</td>
        <td><i id="{{ client.pk }}" style="color:red" class="fas fa-trash-alt" href="{% url 'management:delete_client' client.pk %}"></i></tr>
        {% endfor %}
        </tbody>
        </table>
    </div>
    <div class="col-md-4 text-center">
      <table class="table">
        <tr><th class="heading" colspan="2">
        <h3>Costs Summary</h3></th></tr>
        {% for cost in costs %}
        <tr><td></td></tr>
        {% endfor %}
        </table>
    </div>
    <div class="col-md-4 text-center">
        <table class="table">
          <tr><th>
          <h3>Server Summary</h3></th></tr>
          </table>
    </div>
</div>

        {% endblock content %}

{% block js %}
<script>
//------------------------------------------------------
$('.client').click(function() {
  window.location.href = $(this).attr('href');
  })

$('.fa-trash-alt').click(function() {
  var id = $(this).attr('id');
  if(confirm("Are you sure you want to delete this client?")) {
    $.get($(this).attr('href'), {}, function(data) {
      if(data.deleted) {
        $('#client-table #row-' + id).remove();
      }
      else {
        console.log("Could not delete client at this time!");
      }
    });
  }
});
</script>
{% endblock js %}
